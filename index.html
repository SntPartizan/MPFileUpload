<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <script>

    function loadFile() {
      const file = document.querySelector("#file").files[0]; 
      submit(file);
    }

    function submit(blob, chunkId = 0) {

      const chunkSize = 1024 * 1024 * 5;
      const chunks = Math.ceil(blob.size / chunkSize)
      const offset = chunkId * chunkSize;
      const chunk = blob.slice(offset, offset + chunkSize)

      if (chunk.size == 0) return;

      const fd = new FormData();
      fd.append("fileToUpload", chunk, 'chunk_' + chunkId);
      fd.append("uid", "{{uid}}");
      const last = (chunkId == chunks - 1)
      fd.append("last", last);

      fetch('/', {
        method: 'POST',
        body: fd
      }).then((resp) => {
        submit(blob, chunkId + 1)
      })
    }

  </script>
</head>

<body>
  <input type="file" id="file" onChange="loadFile()">
</body>

</html>