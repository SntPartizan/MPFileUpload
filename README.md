# MPFileUpload

В проекте используется сервис MinIO Object storage(https://min.io/)

Конфигурация проекта задается в файле config.toml

Секретный ключ для MinIO задается через переменную окружения в файле .env SECRET_KEY='XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'

Интерфейс для загрузки файлов доступен по умолчанию по адресу http://localhost:8080

Описание алгритма работы:
1. Загружаемый файл "режется" на куски определенного размера(задается в кофигурации) средствами JavaScript, которые отправляются в точку загрузки данных /upload
2. Загруженный кусок созраняется на диск, добавляется в "очередь" на асинхронную загрузку на S3-сервер. В тот же момент клиент получает ответ о завершении загрузки куска файла.
3. Клиент начинает отправлять следующий кусок файла. Сервер продолжает асинхронно отправлять предыдущие куски на S3-сервер.
4. Пункты 2,3 повторяются до полной загрузки файла клиентом.
5. При получении последнего куска, сервер дожидается отправления всех предыдущих кусков на S3. После чего отправляет команду S3-серверу на удаленное объединение кусков в единый файл.
6. Готовый файл сохраняется в bucket указанный в config.toml, временный bucket с кусками удаляется.
     



